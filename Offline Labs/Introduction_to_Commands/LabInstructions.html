<!DOCTYPE html>
<!-- saved from url=(0047)https://labondemand.com/LabProfile/Manual/LABID -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>Local Lab Instructions</title>


    <script src="./Content/jquery-2.1.4.min.js.download" type="text/javascript"></script>
    <script src="./Content/showdown.min.js.download"></script>
    <link rel="stylesheet" type="text/css" href="./Content/prettify.css">
    <script src="./Content/yaml.min.js.download"></script>
    <script src="./Content/LocalizeTo" type="text/javascript"></script>
    <link href="./Content/CloudClient.css" rel="stylesheet" type="text/css">
  
    <style type="text/css">
        body, html {
            font-family: Segoe UI,Tahoma,Verdana,Arial,sans-serif;
            font-size: 14px;
            padding: 0;
            margin: 0;
            background-color: #efefef;
            color: #000;
            height: 100%;
        }

        body {
            overflow:auto;
        }

        #outputWrapper {
            background-color: #efefef;
            min-height:100%;
        }

        .instructionsPreview {
            padding: 20px;
            height: 100%;
        }

        .instructionsPreview .page {
            position:relative;
            display: block !important;
            padding: 15px 20px;
            background-color:#fff;
            page-break-after: always;
            min-height:40px;
        }

        .instructionsPreview .page:not(:first-child) {
            margin-top:20px;
        }

        @media print {
            body, html{
                height:auto;
            }
            
            body {
                -webkit-print-color-adjust: exact;
            }

            div {
                page-break-inside: avoid;
            }

            #outputWrapper {
                background-color: transparent;
            }

            .instructionsPreview {
                padding: 0;
            }

            .instructionsPreview .page:not(:first-child) {
                margin-top: 0px;
            }

        }

        @page {
            margin-left: 1.5cm;
            margin-right: 1.5cm;
            margin-top: 1.5cm;
            margin-bottom: 1.5cm;
        }
    </style>
    <link id="themeStylesheet" href="./Content/Blue.css" rel="stylesheet">

</head>
<body>
    <div id="outputWrapper">
                <div id="instructions" class="instructionsPreview">
    </div>
    <input type="hidden" id="rawContent" value="[TemplateVersion]:
&#39;1.0&#39;

[LODLabID]:
&#39;38671&#39;

[LODLabNumber]:
&#39;01 FS.Commands&#39;

[AdminPowerShell]:
```
powershell -NoProfile -command &quot;Start-Process powershell -Verb RunAs&quot;
exit
```

[AdminPowerShellISE]:
```
powershell -NoProfile -command &quot;Start-Process powershell_ise -Verb RunAs&quot;
exit
```

# Welcome student to the module: Introduction to Commands

There are many types of commands that can be invoked from PowerShell. For the native command types (i.e. Function and Cmdlet) there is a best practice naming convention of Verb-Noun. Adhering to this naming conventions simplifies the discovery of these type of commands. Native commands are defined to accept input (i.e. arguments) via parameters. All arguments can be passed as input to a command by specifying the name of the parameter it is intended for (i.e. named argument) or if so defined can also be passed in implicitly for a parameter based on it&#39;s position in the argument list (i.e. positional argument).

## Estimated time to complete this lab:

**45 minutes**

## Objective

After completing this lab you will be able to:

- Launch the PowerShell console and the PowerShell Integrated Scripting Environment (ISE).
- Discover and Execute PowerShell commands.
- Find help for PowerShell commands.
- Use commands to perform simple administrative tasks.

===

# Login to Windows 10 and Start the Lab

Login to **win10(wdt** machine with the given credentials. You can find them on the **Resources** pane.

Please login with Username: **+++Power+++** and Password: **+++Pa$$w0rd+++**

After logging in wait until you see the &quot;Lab preparation has been completed&quot; in the action center (This can take up to 2 minutes). If this does not popup you can click in the bottom right of the Vm to open the action center. Begin by opening Windows PowerShell ISE by right clicking on the PowerShell icon and selecting **Run ISE as an Administrator**, or by clicking @[Run ISE as Administrator.][AdminPowerShellISE]{shell visible}

> [!TIP] **Notes about using the lab**
> - It might take a moment to start ISE if you click the above link
> - You can click the **+++Type Text+++** icon to enter the highlighted text at the position of the cursor in the virtual machine. You can also click on the **++Copy to Clipboard++** icon and then paste in at the desired destination.
> - Entering your code in the script pane of the ISE will allow for better troubleshooting if you find errors
> - Remember that the PowerShell ISE will allow you to highlight multiple lines of PowerShell code and run them together by pressing **F8**

===

# Exercise 1: Cmd.exe vs PowerShell.exe

Traditionally Microsoft Windows has included the command console (i.e. cmd.exe) to execute commands. Windows PowerShell provides backward compatibility to continue to use these legacy commands, or to use Windows PowerShell&#39;s native commands (functions, cmdlets).

## Objectives

After completing this exercise, you will be able to:

- Execute Windows PowerShell from within the Windows command prompt.
- Launch Windows PowerShell&#39;s own command console and ISE.
- Use basic Windows PowerShell Cmdlets to get help.

===

# Task 1.1: Execute PowerShell from cmd.exe

1. [] Login to Windows 10 with the given credentials. You can find them on the **Resources** pane.

    >[!TIP] Click the **+++Type Text+++** icon to enter the highlighted text into at the position of the cursor in the virtual machine. You can also click on the **++Copy to Clipboard++** icon and then paste in at the desired destination.

    >[!TIP] Where there are multiple lines of PowerShell code to be executed either one line at a time or together, a good tip is to paste them into a Script Pane in PowerShell ISE and then by simply setting the cursor on the line to be executed and pressing **F8** the line will be selected and invoked. If specific portions of a line or multiple lines should be invoked, select these specifically and then press **F8**.

1. [] **Left click** the **Windows-button** on the lower left corner of the screen and type **+++cmd+++**. Then right click on **Command Prompt** and select **Run as Administrator**. Type and execute the following commands into the console:

    >[!NOTE] **Note:** You may be prompted by **User Account Control** to allow changes to your device. Select **Yes** if prompted.

     +++cd c:\windows+++

     +++dir+++

     +++cls+++

     +++ipconfig+++

     +++ping MS+++

     +++net share+++


1. [] Now you will invoke the same commands from the **PowerShell console**. To launch the PowerShell **Left click** the **Windows-button** on the lower left corner of the screen and type **+++powershell+++**. Then left click **Windows PowerShell** or by clicking @[Run Console as Administrator.][AdminPowerShell]{shell visible}.

    >[!KNOWLEDGE] You can see **PowerShell** is running because the prompt has changed to be prefixed with **PS**. In addition you will see some color coding of the text you type.

1. [] Now type the and execute same commands as before and notice the differences and similarities:

     +++cd c:\windows+++

     +++dir+++

     +++cls+++

     +++ipconfig+++

     +++ping MS+++

     +++net share+++

1. [] Type **+++exit+++** to leave Windows PowerShell

1. [] Type **+++exit+++**, to close the Windows Command console.

===

# Task 1.2: Executing PowerShell native commands from the PowerShell console.

1. [] **Right-click** the PowerShell icon on the taskbar and select the &quot;**Run as Administrator**&quot; option or click @[Run Console as Administrator.][AdminPowerShell]{shell visible}.  This will launch the Windows PowerShell console shell.

1. [] In the previous task you attempted to execute commands with the same names as known commands accessible through the cmd console. Little did you know, but some of the commands executed in the PowerShell console were external applications and other were internal native commands (i.e. Alias, Function, Cmdlets). Now type the following native Windows PowerShell commands and observe the similarity and difference again in output from the previous tasks:

    +++Set-Location C:\Windows+++

    +++Get-ChildItem+++

    +++Clear-Host+++

    +++Get-NetIPConfiguration+++

    +++Get-NetIPConfiguration -Detailed+++

    +++Test-Connection MS+++

    +++Get-SMBShare+++

    >[!KNOWLEDGE] These PowerShell commands return similar information as the shell commands you typed before. But don&#39;t let that fool you. What you see is not always what you get. The return values from PowerShell execution are **Objects** however they are shown as text. More on objects in later modules.

    >[!KNOWLEDGE] Notice the regularity of the **native** PowerShell command names (*Verb-Noun*). This makes it easy to understand what any given Windows PowerShell command will do.

1. [] What do you think the name of a command would be to get help?

    <details>
    <summary>Hint</summary>

    What is the name of the command in the command console? Try typing **Help** and see what happens.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Get-Help+++
    </details>


1. [] What do you think the command would be to **get** a list of commands?

    <details>
    <summary>Hint</summary>

    Think of what possible verbs and nouns make sense for such a command. The **noun** should describe the resulting objects (command) and the **verb** should describe and action to retrieve objects with.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Get-Command+++
    </details>

1. [] Type **+++exit+++** to close the Windows PowerShell console.

===

# Task 1.3: Executing PowerShell native commands from PowerShell ISE

1. [] Begin by opening Windows PowerShell ISE by **right clicking** on the **PowerShell icon** and selecting &quot;*Run ISE as an Administrator*&quot;, or by clicking @[Run ISE as Administrator.][AdminPowerShellISE]{shell visible}.


    >[!NOTE]**Note:** The Windows PowerShell Integrated Scripting Environment (ISE) is a host application for Windows PowerShell.
    >
    >In Windows PowerShell ISE, you can run commands and write, test, and debug scripts in a single Windows-based graphic user interface with multi-line editing, tab completion, syntax coloring, selective execution, context-sensitive help, and support for right-to-left languages.
    >
    >You can use menu items and keyboard shortcuts to perform many of the same tasks that you would perform in the Windows PowerShell console.

1. [] You will now be shown how **IntelliSense** works which is provided  the PowerShell parser. **IntelliSense** is a mechanism that based on context, will offer words for completion of a command. Type the following PowerShell commands in the **blue** console pane.

    ```Powershell-notab-nocopy
    Get-
    ```

    >[!NOTE]**Note:** Wait for the IntelliSense (options for completion) drop down list to appear.

1. [] You will see how the options change based on your input. Type the letters **pro**.

    >[!KNOWLEDGE]Watch as IntelliSense filters the list of commands.

1. [] Press ***Enter*** to select the highlighted command.

1. [] Press ***Enter*** to execute the command.

1. [] **IntelliSense** can also work for offering possible arguments for some of the parameter. Type the following command, than use the **Tab** key to see IntelliSense complete the argument for the parameter:

    ```Powershell-notab-nocopy
    Get-Process -Name
    ```

1. [] PowerShell uses the **space character** as a delimiter when parsing the words (*tokens*). Once a space is inserted, the *parameter* ends and the *argument* starts.  Press the ***Spacebar***.

    >[!NOTE]**Note:** A list of currently running processes (i.e. *arguments*) will appear in a drop down list. The values are offered as possible values (i.e. *arguments*) for the parameter *Name*.

1. [] Select the process ***spoolsv*** and press ***Enter***.

1. [] IntelliSense is also available in the **PowerShell console shell**

    1. [] **Right-click** the **PowerShell icon** on the taskbar and select the &quot;**Run as Administrator**&quot; option or click @[Run Console as Administrator.][AdminPowerShell]{shell visible}.  This will launch the Windows PowerShell console shell.

    1. [] Type the following command and then use **CTRL** + **Spacebar** to trigger IntelliSense:

        ```Powershell-notab-nocopy
        Get-Process -
        ```

    1. [] Select the parameter **Name** by highlighting it and press **Enter**.

1. [] Exit the PowerShell shell by typing +++exit+++.

===

# Exercise 2: Command Discovery

PowerShell provides an environment in which a large number of commands can be executed.

In this exercise you will learn how to **discover** these commands.

## Objectives

After completing this exercise, you will be able to:

- Discover PowerShell Commands.

===

# Task 2.1: Using Get-Command

Windows PowerShell exposes thousands of native commands (i.e. CmdLets, Functions, Alias and Scripts). The ability to **search** for a relevant command is vital.

1. [] Type the following in the current **Windows PowerShell ISE** command pane and watch IntelliSense show the possible parameters available for the command.

    +++Get-Command -+++

    >[!NOTE] **Note:** Observe the &#39;-&#39; to denote a parameter name. A list of all possible parameters will appear.

1. [] Scroll through the list or Press **TAB** to in order to cycle through the parameters.

1. [] Which command can you use to query for commands that start with **Get**?

    <details>
    <summary>Hint</summary>

    You can use the **Get-Command -** and let IntelliSense complete all possible params to look at the possible values again.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Get-Command -Verb Get+++
    </details>

1. [] Which command and parameter can you use to query for commands that end with **service**?

    <details>
    <summary>Hint</summary>

    You can use the **Get-Command -** and let IntelliSense complete all possible params to look at the possible values again.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Get-Command -Noun Service+++
    </details>

1. [] You will now call a command by specifying only a argument and not the name of the parameter.

    Type the following command to see if it works:
    ```-nocopy
    Get-Command *service
    ```

    >[!NOTE] **Note:** There is no parameter name specified in the above command, still it works. This is known as passing a positional argument. There could be several positional arguments and the trick is knowing in which order they need to be passed, else the wrong argument will be assigned the wrong parameter. Position is part of the automatic mapping of arguments, to parameters when no name is given. This is not a best practice when writing scripts and is prone to cause bugs.


1. [] Binding an argument to a parameter is equivalent to assigning a value to a variable. Using the sample below, to which parameter is the filter string ***service** bound as an argument.

    ```-nocopy
    Get-Command *service
    ```

    <details>
    <summary>Hint</summary>

    Take a look at the syntax of the command **Get-Command** by typing:
    ```-nocopy
    Get-Command Get-Command -Syntax
    ```
    Which parameter name(s) are optional (i.e. decorated like this [-ParameterName]).
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    There are two parameters that take arguments for which the parameter names are optional. These are **-Name** and **-ArgumentList**. The -Name parameter is the only one that requires a string (plain text) as an argument however.
    </details>

1. [] How would you invoke the **Get-Command** in order to get the results specified for each result criteria below.

 | # | Results Criteria                              | Command to Invoke |
 |:---:|:---- |:--- |
 | 1 | PowerShell native commands that have the verb **Suspend**             | [Answer](&quot;Get-Command -Verb Suspend&quot;) |
 | 2 | PowerShell native commands that have a Parameter named **FilePath**   | [Answer](&quot;Get-Command -ParameterName FilePath&quot;) |
 | 3 | All Cmdlets that have the word **Computer** as part of their name     | [Answer](&quot;Get-Command -CommandType Cmdlet -Name \*Computer\*&quot;) |

    <details>
    <summary>Hint</summary>

    Look at the help for Get-Command using

    +++Get-Help Get-Command+++

    and/or

    +++Get-Command -Name Get-Command -Syntax+++.
    </details>


===

# Exercise 3: Command Syntax

When commands are executed we need to understand the correct syntax of that command to execute it successfully.

In this exercise we will learn how to **discover the syntax** of the native PowerShell commands.

## Objectives

After completing this exercise, you will be able to:

- Explore the syntax of native PowerShell commands.
- Explore the syntax with Get-help.
- Working with common parameters.

===

# Task 3.1: Exploring Syntax


1. [] There are several ways to see a commands syntax. You either look in the help content using *Get-Help* or you can use the *-Syntax* switch for the **Get-Command** command. Look at the syntax for the command *Get-Service* by executing the below.
    >[!NOTE] **Note:** In order to execute the code below from the ISE Script pane, place the cursor in the line with the command and press **F8**.

    ```PowerShell-notab-nocopy
    Get-Command Get-Service -Syntax
    ```

2. [] In order to understand the characters used in the syntax diagrams, read the Help by executing following:

    +++Get-Help about_command_syntax+++

3. [] What do the square brackets represent in the following help excerpt? **&lt;string\[\]&gt;**

    <details>
    <summary>Hint</summary>

    +++Get-Help about_command_syntax+++
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    The parameter accepts multiple comma separated values (i.e. an Array).
    </details>


4. [] In the first parameter set for **Get-Service**, is the providing the parameter name *-Name* optional?


    [Yes or No?](&quot;Yes&quot;)

    <details>
    <summary>Hint</summary>

    Are there **square brackets []** around the parameter **name**?
    </details>


5. [] Some parameters that accept a strings as arguments, also support **wildcard characters** such as **&#39;*&#39;**. How would you call **Get-Service**, in order to return all services that have **&quot;background&quot;** in the beginning of their **DisplayName**?

    <details>
    <summary>Hint</summary>

    Look at results of +++Get-Help about_Wildcards+++ and +++Get-Help Get-Service -Parameter DisplayName+++.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Get-Service -DisplayName background*+++
    </details>



6. [] Try to run the command below with the two given parameters and values. When you execute the command below what happens? Can you explain why?

    +++Get-Service -DisplayName background* -name b*+++

    <details>
    <summary>Hint</summary>

    Look at the result of +++Get-command Get-Service -Syntax+++. Can both parameters be used in the same command invocation?
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    The error states: *&#39;Get-Service : Parameter set cannot be resolved using the specified named parameters.&#39;*.
    This indicates that the parameters being used cannot be used together as they are in different **parameter sets**. The syntax will show that DisplayName and Name are in separate parameter sets.
    </details>

7. [] If you are trying to invoke a PowerShell native command and forget the syntax, you can call on the help through a trick by using &#39;**?**&#39; as a parameter name. Execute the command to see the results.

    +++Add-Computer -?+++

8. [] Referring to the syntax for the *Add-Computer* Cmdlet, is it required to specify the parameter name *-DomainName* when you want to pass an argument to it?

    <details>
    <summary>Hint</summary>

    +++Get-Command -Name Add-Computer -Syntax+++
    Are there square brackets (&#39;[]&#39;) around the parameter name ?
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    **NO**. The parameter name is optional, however an argument is mandatory. For this reason the argument&#39;s position in the list of arguments without specified name will dictate which parameter it will be assigned to.
    </details>

9.  [] Execute the following command and based on the result, try to explain why it fails and what can be changed to make it succeed.

    +++Get-Service -ComputerName+++

    <details>
    <summary>Hint</summary>

    The error is pretty much self-explanatory, however you can have confirmation by looking at the syntax for the command.

    +++Get-command Get-Service -Syntax+++

    </details>
    <br>
    <details>
    <summary>Answer</summary>

    The parameter *ComputerName* requires a string or list or comma separated strings with the name(s) of the computer(s) on which to query the service(s).
    </details>

10. [] Based upon the error output, does the **-ComputerName** parameter accept multiple values?

    <details>
    <summary>Answer</summary>

    **Yes**. The parameter accepts multiple string values separated by a comma. System.String[]
    </details>


11. [] How would you describe a &quot;parameter set&quot;?

    <details>
    <summary>Hint</summary>

    +++Get-help about_command_syntax+++
    </details>

    <details>
    <summary>Answer</summary>

    A subset of parameters with at least one that is unique to the set. Only parameters in the same set may be used together. One of the reasons for this is to separate conflicting parameters.
    </details>


12. [] Try a different way than using **Get-Command** to find out how many parameter sets are available for the **Get-Service** Cmdlet.

    <details>
    <summary>Hint</summary>

    You can look at the parameter sets executing the below. Each tab represents a parameter set.

    +++Show-Command -Name Get-Service+++
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    Three - Default, DisplayName and Input. The names of the parameters sets can be seen as the Tab **title** when using **Show-Command**.
    </details>


===

# Task 3.2: Using the built-in Help system by using the Get-Help command.

1. [] The command **Get-Help** will show you general help information.

    +++Get-Help+++

1. [] Get help has a set of documentations called **about**. You can see all of the about topics using the following command:

    +++Get-Help about_*+++

1. [] Can you also use **Get-Help** to find out syntax information about a command ?

    [Yes or No?] (&quot;Yes&quot;)


1. [] The Get-help command also supports opening a website on the internet with help information. What is the parameter name to do this?

    <details>
    <summary>Hint</summary>

    Try looking up the syntax of the Get-Help command
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Get-Help Get-Service -Online+++
    </details>

    >[!NOTE] **Note:** The machine must be internet-connected for the command to succeed.

1. [] There are several interesting parameters that can be used to both filter the help results as well as only show certain portions of the help text, below are a few examples.

    Another way to run commands in **Powershell ISE** is to copy these by clicking on the **Copy Icon** and paste the into the script pane of PowerShell ISE. Then execute them line by line by moving the cursor to the line to be executed and pressing **F8**.

    ```PowerShell-notab
    # Will get the default help for Get-Service command.
    Get-Help Get-Service

    # Will display only the examples that are provided for the Get-Service command
    Get-Help Get-Service -Examples

    # This calls a function which in turn calls the Cmdlet Get-Help
    Get-Help Get-Service -Examples

    # This will show all sections of the help content for Get-Service
    Get-Help Get-Service -Full

    # This is very useful as it allows one to search the help content via a GUI interface
    Get-Help Get-Service -ShowWindow
    ```

    >[!KNOWLEDGE] The last command opened a new dialog window that displayed help for the Get-Service cmdlet.

    While using the open window from the last command:

    1. []  You can filter out sections displayed by the GUI. To do this **Click** the **Settings** button.

    1. [] **Toggle** some of the sections by un-checking or checking some of the checkboxes and then click **OK**. See how the content changes based on these setting changes?

        >[!NOTE] **Note:** For most of the checkboxes in the settings dialog, there is a corresponding switch parameter, that can be used when calling **Get-Help**.

    1. [] Now try to search the resulting help content using the word **Include** in the **Find** text box.

        >[!NOTE] **Note:** Scroll down and find the yellow highlights that appear. Find the help for the *-Include* parameter.


    1. [] There are several attributes for parameters that any given native PowerShell command can have. The simplest way to view these is in the help content. These attributes are not visible in the command syntax. Examine the attribute *Accept pipeline input* for the **-Include** parameter. Does this parameter accept pipeline input?

        <details>
        <summary>Answer</summary>

        **No**. Accept pipeline input? false.
        </details>

        >[!NOTE] **Note:** You will learn more about passing arguments to parameters through the pipeline in the module about pipelining.


    1. [] Does this parameter accept wildcard characters?

        <details>
        <summary>Answer</summary>
        **No**. Accept wildcard characters? false.
        </details>

        >[!NOTE] **Note:** Unfortunately, this attribute&#39;s value is not always accurate. Sometimes the attribute is false but still accepts wildcards. If the parameter takes arguments of type *string* it is always worth while still trying to use wildcards.

1.  [] Finally, close the **Get-Service Help** dialog.

===

# Task 3.3: Common Parameters

Common parameters are parameters that all native Cmdlets, as well as advanced functions get, without having to define them. Read more about these, in the help, by executing the below.

+++Get-Help about_CommonParameters -ShowWindow+++

1. [] There are a few command parameters which are classified as &quot;**Risk Mitigation**&quot; parameters. What are the names of these parameters and what do they do?

    <details>
    <summary>Hint</summary>

    Look at the about_CommonParameters help and Search for the word *Risk* in the content.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    **-WhatIf** and **-Confirm**
    </details>

1. [] Find a command that you would like to test the **WhatIf** common parameter on. How would you find a command that has a parameter with the name **WhatIf**? Once you found a command remember the name for the next task.

   <details>
   <summary>Hint</summary>

   Look at the parameters for the command Get-Command.
   </details>
   <br>
   <details>
   <summary>Answer</summary>

   +++Get-Command -ParameterName WhatIf+++
   </details>


1. [] Read the output after executing the command you chose in the last task, in order to understand what the *-WhatIf* switch parameter actually does. An Example could be:

+++Stop-Service w32time -WhatIf+++

1. [] Did the command actually make any changes

   [Yes or No?](&quot;No&quot;)

1. [] How can you validate the answer to the last question?

    <details>
    <summary>Hint</summary>
    It there a way to *Get* the object that the command you chose should have changed?
    </details>
    <br>
    <details>
    <summary>Answer</summary>
    As an example if you chose **Remove-Item -WhatIf -Path &#39;.\SomeFile.txt&#39;**, Check if the if the file still exists with **Get-Item -Path &#39;.\SomeFile.txt&#39;**.
    </details>

1. [] Try to start *notepad* using the command **Start-Process** in a way that the notepad window is minimized.

    <details>
    <summary>Hint</summary>

    Look at the **help** for **Start-Process**. Is there any parameter that allows the window style to be determined?
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Start-Process -FilePath notepad -WindowStyle Minimized+++
    </details>

1. [] What command would you use to stop the process and ensure Windows PowerShell prompts you for confirmation?

    <details>
    <summary>Hint</summary>

    +++Get-Command -Noun Process+++
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Stop-Process -Name notepad -Confirm+++
    </details>

1. [] Imagine that you would want to stop all process that the get command below would return, but you realise later on that the input variable (*$nonexistent*) was empty. what would be the result if you did not use **-Confirm**?.

    +++get-service $nonexistent+++

    <details>
    <summary>Answer</summary>

    You can cause a potential impact on the machine because you stopped the wrong services due to the fact that get command did not check for a empty value and thus returned all The Services objects. So use the *-Confirm* parameter to reduce the risk.
    </details>

===

# Exercise 4: Alias Commands

Aliases save time when typing at the Windows PowerShell console. As a best practice they should be avoided in scripts as they only causing confusion when someone else try`s to read your code. Other aliases have been implemented to make it easier for admins of other OS systems as they will be able to relate the command names they are used to, to those native to PowerShell.

## Objectives

After completing this exercise, you will be able to:

- Find what aliases are defined.
- Create a new aliases.

===

# Task 4.1: Finding and Using Aliases

1. [] List all commands with **alias** in their name using the **+++Get-Command+++** command.

    <details>
    <summary>Hint</summary>

    Look at the parameter *-CommandType*.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++Get-Command -Name \*alias\* -CommandType Cmdlet+++
    </details>


1. [] Which command(s) will get all aliases? Execute this command and notice first three aliases below.

    <details>
    <summary>Hint</summary>

    Look at the parameter *-CommandType* again for the command **Get-Command** as well as the results of the previous step.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    Using Get-Command:
    +++Get-Command -CommandType Alias+++

    Or using Get-Alias:
    +++Get-Alias+++

    Notice the difference in results. Get-Command will list all the available alias commands on computer and Get-Alias only the ones that are currently defined in memory.
    </details>

1. [] Open up the help for **Get-Alias** in a window, so that we can search through it in later steps.

    +++Get-Help Get-Alias -ShowWindow+++

1. [] Search the parameters in the help and look for one that finds all aliases for a given command.
    <br>
    <details>
    <summary>Answer</summary>

    The parameter is **-Definition**.

    Here is an example to retrieve all aliases for the Get-Process command:
    ```PowerShell-notab
    Get-Alias -Definition Get-Process
    ```
    </details>


1. [] Now list all the aliases currently defined.

    +++Get-Alias+++

1. [] **Notice:** Many of them are commands that you are familiar with in other shell environments, such as the &quot;**Cmd Console**&quot; or one of the many &quot;\***nix shells**&quot;. Below are a few of the aliases. Aliases are simply references to other native PowerShell commands. There can be several aliases for the same command. How would you list commands they are referencing as well as the other aliases that reference the same commands.

    What are names of the commands that the aliases below reference?

    | #  | Alias     | Command referenced  |
    | :--| :-- | :-- |
    | 1  | dir       | [Answer](&quot;Get-ChildItem&quot;) |
    | 2  | pwd       | [Answer](&quot;Get-Location&quot;)  |
    | 3  | cd        | [Answer](&quot;Set-Location&quot;)  |
    | 4  | mount     | [Answer](&quot;New-PSDrive&quot;)   |
    | 5  | sleep     | [Answer](&quot;Start-Sleep&quot;)   |
    | 6  | start     | [Answer](&quot;Start-Process&quot;) |
    | 7  | kill      | [Answer](&quot;Stop-Process&quot;)

    <details>
    <summary>Hint</summary>

    In order to find out which commands they refer to look at +++Get-Alias+++.

    </details>

===

# Task 4.2: Creating Aliases

1. [] What cmdlet would you use to create a new alias?

    <details>
    <summary>Hint</summary>

    Try using the **Get-command** to find a command that can work with aliases.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    +++New-Alias+++
    </details>

1. [] Is there an alias named *reboot* ?

    <details>
    <summary>Hint</summary>

    +++Get-Alias -Name reboot+++

    or

    +++Get-Command -Name Reboot -CommandType Alias+++

    </details>
    <br>
    <details>
    <summary>Answer</summary>

    **No** - When either hint is executed an error message is shown stating there is no such command (i.e. Alias).
    </details>

1. [] What command and with which arguments do you need to call it in order to perform the following actions.

 | #  | Action                                                                   | Command                                                |
 | :--| :-- | :-- |
 | 1  | Find the command which have a noun *computer*.                           | [Answer](&quot;Get-Command -Noun Computer&quot;)                |
 | 2  | Which command will restart a computer?                                   | [Answer](&quot;Restart-Computer&quot;)                           |
 | 3  | Create an Alias for the previous command with the name &#39;rc&#39;             | [Answer](&quot;New-Alias -Name RC -Value Restart-Computer&quot;) |
 | 4  | Invoke the Alias using the **-WhatIf** common parameter on the Computer &#39;MS&#39; | [Answer](&quot;RC -ComputerName MS -WhatIf&quot;)                |

===

# Self test (Optional part of the course)

## Self test information

The following self test is a optional part of this course and can be used to evaluate if your knowledge of the subject matter is sufficient. You can use this self test to re-evaluate your knowledge after taking the course or test your knowledge before you take / retake the course.

This self test exists out of 10 questions and or exercises. To get a fair result you should complete this self test using your knowledge only and not using any internet search engines.

##  Self test duration

Although the self test is not timed this test should be completed in approximately 15 minutes.

To start the self test continue to the next page

===

## Self test Part 1: Questions

1. <Removed>
___
2. <Removed>
___
3. <Removed>

## Self test Part 2: Exercises

Try to find the answers or perform the activities of the following exercises. You can use the virtual machines to find the answer or perform the actual activity there. If there is no answer box, The score button will check against the Virtual machine for proper configuration.

1. <Removed>
___
2. <Removed>
___
3. <Removed>
___
4. <Removed>
___
5. <Removed>
___
6. <Removed>
___
7. <Removed>
___
8. <Removed>
___
9. <Removed>">
    <input type="hidden" id="activities" value="[]">
    <input type="hidden" id="replacementTokens" value="[{&quot;Token&quot;:&quot;@lab.LabProfile.Id&quot;,&quot;Replacement&quot;:&quot;38671&quot;},{&quot;Token&quot;:&quot;@lab.CtrlAltDelete&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;ctrlAltDeleteLink&#39;&gt;Ctrl+Alt+Delete&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(WIN10).SelectLink&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;selectMachineLink&#39; data-data=&#39;63124&#39;&gt;WIN10&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(WIN10).Username&quot;,&quot;Replacement&quot;:&quot;Power&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(WIN10).Password&quot;,&quot;Replacement&quot;:&quot;Pa$$$$w0rd&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(MS).SelectLink&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;selectMachineLink&#39; data-data=&#39;54597&#39;&gt;MS&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(MS).Username&quot;,&quot;Replacement&quot;:&quot;Power&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(MS).Password&quot;,&quot;Replacement&quot;:&quot;Pa$$$$w0rd&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(DC).SelectLink&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;selectMachineLink&#39; data-data=&#39;54598&#39;&gt;DC&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(DC).Username&quot;,&quot;Replacement&quot;:&quot;Administrator&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(DC).Password&quot;,&quot;Replacement&quot;:&quot;Pa$$$$w0rd&quot;},{&quot;Token&quot;:&quot;@lab.OpticalMedia(5638).LoadLink&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;loadMediaLink opticalMedia&#39; data-data=&#39;5638&#39;&gt;Introduction to Commands - 0050&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.LabInstance.Id&quot;,&quot;Replacement&quot;:&quot;[ID]&quot;},{&quot;Token&quot;:&quot;@lab.LabInstance.GlobalId&quot;,&quot;Replacement&quot;:&quot;[lodID]&quot;},{&quot;Token&quot;:&quot;@lab.LabInstance.StartDate&quot;,&quot;Replacement&quot;:&quot;20190108&quot;},{&quot;Token&quot;:&quot;@lab.User.Id&quot;,&quot;Replacement&quot;:&quot;[USERID]&quot;},{&quot;Token&quot;:&quot;@lab.User.FirstName&quot;,&quot;Replacement&quot;:&quot;[FIRSTNAME]&quot;},{&quot;Token&quot;:&quot;@lab.User.LastName&quot;,&quot;Replacement&quot;:&quot;[LASTNAME]&quot;},{&quot;Token&quot;:&quot;@lab.User.Email&quot;,&quot;Replacement&quot;:&quot;[EMAIL]&quot;},{&quot;Token&quot;:&quot;@lab.User.ExternalId&quot;,&quot;Replacement&quot;:&quot;[EXTERNALID]&quot;},{&quot;Token&quot;:&quot;@lab.Tag&quot;,&quot;Replacement&quot;:&quot;[TAG]&quot;}]">

    <textarea id="copyInput" value="" style="position: absolute; left:-10000px; top:-10000px; "></textarea>

    <script type="text/javascript"> 
    
        String.prototype.replaceAll = function(search, replacement) {
            var target = this;
            return target.replace(new RegExp(search, 'g'), replacement);
        };

        var childWindows = [];

        function showClickFeedbackMessage(text, x, y, duration) {
            var $message = $("<div class='clickFeedbackMessage noselect'>" + text + "</div>");
            $message.appendTo($("body")).hide();
            $message.css({ left: x, top: y });
            $message.fadeIn("fast");
            window.setTimeout(function () {
                $message.fadeOut("fast", function () { $message.remove(); });
            }, duration);
        }

        function copyableClicked(element) {
            //only copy if we are clicking, not if we have used the mouse to select the text manually.
            var selectedText;
            if (window.getSelection) {
                selectedText = window.getSelection().toString();
            } else if (document.selection && document.selection.type !== "Control") {
                selectedText = document.selection.createRange().text;
            }
            if (selectedText) { return };

            var $element = $(element);
            var text = $element.text();
            $("#copyInput").val(text).select();
            var offset = $element.offset();
            var x = offset.left;
            var y = offset.top - 40;
            try {
                var successful = document.execCommand("copy");
                if (successful) {
                    showClickFeedbackMessage("Copied to clipboard", x, y, 2000);
                } else {
                    showClickFeedbackMessage("Copying was unsuccessful", x, y, 2000);
                }
            } catch (err) {
                showClickFeedbackMessage("Copying was unsuccessful", x, y, 2000);
                console.log("Unable to copy. " + err);
            }
        }

        function setupKnowledgeExpanders() {
            $(".knowledge").each(function () {
                var knowledge = this;
                var $knowledge = $(this);
                var $moreKnowledge = $knowledge.next();
                if ($moreKnowledge.is(".moreKnowledge")) {
                    var maxHeight = 100;
                    var leeway = 100;
                    var diff = knowledge.scrollHeight - maxHeight;
                    if (diff < leeway) {
                        $knowledge.removeClass("collapsed");
                        $moreKnowledge.find("a").hide();
                    } else {
                        //this is tall content, let's show the 'more' link
                        $moreKnowledge.find("a").show();
                        $knowledge.addClass("collapsed");
                    }
                }
            });
        }

        var variables = {};

        function processVariables() {
            $("span.variable").each(function () {
                var $this = $(this);
                var name = $this.attr("data-name");
                if (name in variables) {
                    $this.html(variables[name]);
                } else {
                    $this.text("<" + name + ">");
                }
            });
            $("input.variableTextBox").each(function () {
                var $this = $(this);
                var name = $this.attr("data-name");
                if (name in variables) {
                    $this.val(variables[name]);
                } else {
                    $this.val("");
                }
            });
            $("code").each(function () {
                var originalHtml = this.originalHtml ? this.originalHtml : this.innerHTML;
                var newHtml = originalHtml;
                for (var name in variables) {
                    var val = variables[name];
                    var regex = new RegExp('<span class="nocode">&lt;' + name + '&gt;</span>', 'g');
                    newHtml = newHtml.replace(regex, val);
                }
                if (originalHtml != newHtml || originalHtml != this.innerHTML) {
                    this.originalHtml = originalHtml;
                    this.innerHTML = newHtml;
                }
            });
        }
        
        window.onload = function () {

            var rawContent = document.getElementById("rawContent").value;
            var contentRoot = "./Content/"
            var activitiesString = document.getElementById("activities").value;
            var activities = (activitiesString == null || activitiesString.length == 0) ? [] : JSON.parse(activitiesString);
            var replacementTokensString = document.getElementById("replacementTokens").value;
            var replacementTokens = (replacementTokensString == null || replacementTokensString.length == 0) ? [] : JSON.parse(replacementTokensString);
            instructionsProcessor.process(rawContent, "instructions", false, contentRoot, replacementTokens,
                function ($page) {
                    setupKnowledgeExpanders();
                },
                activities
            );
            $(".page").each(function () {
                var $page = $(this);
                if ($page.find("iframe.externalManual").length > 0) {
                    $page.css("padding", 0);
                }
            });

            $("body").on("click", ".moreKnowledgeLink", function (e) {
                e.preventDefault();
                var $link = $(this);
                var $knowledge = $link.parent().prev();
                if ($knowledge.hasClass("expanded")) {
                    $knowledge.removeClass("expanded");
                    $link.text("more...");
                } else {
                    $knowledge.addClass("expanded");
                    $link.text("...less");
                }
            }).on("click", ".copyable, code:not(.nocopy)", function (e) {
                copyableClicked(this);
            }).on("click", ".dialogLink", function (e) {
                e.preventDefault();
                e.stopImmediatePropagation();
                var $dialogLink = $(this);
                var title = $dialogLink.attr("title");
                var target = $dialogLink.attr("data-target");
                if (target) {
                    var $hiddenDialog = $("blockquote.referenceContent[data-id='" + target + "']");
                    if ($hiddenDialog.length === 0) {
                        alert('CONTENT ERROR: Unable to find a reference content "' + target + '"');
                    } else {
                        showDialog({title:title, content: $hiddenDialog.html() });
                    }
                }
                else {
                    showDialog({title:title, url: $dialogLink.attr("href"), isInstructions: $dialogLink.hasClass("instructions") });
                }
            }).on("click", ".videoLink, video", function (e) {
                e.preventDefault();
                var videoUrl = $(this).hasClass("videoLink") ? this.href : this.src;
                var url = "./Content/" + videoUrl.split('Content/').pop().replace(/\#(.*?)$/, '').replace(/\?(.*?)$/, '')
                if (this.title) {
                    
                }
                var videoWindow = window.open(url, "videoWindow", "menubar=no,location=no,resizable=yes,scrollbars=yes,status=no");
                childWindows.push(videoWindow);
                try {
                    videoWindow.focus();
                } catch (e) {

                }
            }).on("click", ".imageLink, img", function (e) {
                var $this = $(this);
                if ($this.parent().is("a")) return;
                e.preventDefault();
                e.stopImmediatePropagation();
                var imgUrl = $this.hasClass("imageLink") ? this.href : this.src;
                var url = "./Content/" + imgUrl.split('Content/').pop().replace(/\#(.*?)$/, '').replace(/\?(.*?)$/, '')
                if (this.title) {
                    
                }
                var imageWindow = window.open(url, "imageWindow", "menubar=no,location=no,resizable=yes,scrollbars=yes,status=no");
                childWindows.push(imageWindow);
                try {
                    imageWindow.focus();
                } catch (e) {

                }
            }).on("click", ".tipLink", function (e) {
                e.preventDefault();
                var $tiplink = $(this);
                var $hiddenTip = $tiplink.next();
                var offset = $(this).offset();
                var x = offset.left;
                var y = offset.top + 25;
                showClickFeedbackMessage($hiddenTip.html().replaceAll('<code title="Copy to clipboard" class="prettyprint">','<code title="Copy to clipboard" style="background-color:#8888;" class="prettyprint">').replaceAll("class",'style="background-color:#8888;" class'), x, y, 5000);
            }).on("change", ".variableTextBox", function () {
                var $textBox = $(this);
                var name = $textBox.attr("data-name");
                var val = $textBox.val();
                if (val == null || val.length == 0) {
                    if (name in variables) {
                        delete variables[name];
                    }
                } else {
                    variables[name] = val;
                }
                processVariables();
            });;

            $(window).resize(function () {
                setupKnowledgeExpanders();
            }).unload(function () {
                closeAllChildWindows();
            });

            function closeAllChildWindows() {
                for (var i = 0; i < childWindows.length; i++) {
                    try {
                        childWindows[i].close();
                    } catch (e) {
                    }
                }
                childWindows = [];
            }

            function showDialog(options) {
                if (!options) return;
                var $dialog = $("#modalDialog");
                var isUpdatedContent = false;
                if ($dialog.length > 0) {
                    $dialog.find(".dialogContent").html("");
                    $dialog.find(".dialogButtons").html("");
                    isUpdatedContent = true;
                } else {
                    var $dialog = $('<div id="modalDialog" class="dialog"><div class="dialogMask"></div><div class="dialogBox"><div class="dialogCloseButton"></div><div class="dialogTitle"></div><div class="dialogContent"></div><div class="dialogButtons"></div></div></div>');
                }
                var $dialogBox = $dialog.find(".dialogBox");
                var close = function () {
                    var h = $dialogBox.outerHeight();
                    var offset = $dialogBox.offset();
                    $dialogBox.css("marginTop", 0).animate({ marginTop: -h - offset.top }, 300);
                    $dialog.delay(200).fadeOut("fast", function () { $dialog.remove(); });
                }
                $dialog.find(".dialogCloseButton").click(close);

                if (options.title) {
                    $dialog.find(".dialogTitle").html(options.title).show();
                } else {
                    $dialog.find(".dialogTitle").hide();
                    $dialog.addClass("noTitle");
                }
                if (options.content) {
                    $dialog.find(".dialogContent").removeClass("noScroll").append(options.content);
                } else if (options.url) {
                    var urlLower = options.url.toLowerCase();
                    if (urlLower.indexOf(".mp4") !== -1) {
                        $dialog.find(".dialogContent").removeClass("noScroll").append('<video src="' + options.url + '" controls autoplay></video>');
                        var $video = $("#contentDialogVideo");
                        try {
                            $video[0].play();
                        } catch (e) {
                            //
                        }
                    } else if (urlLower.indexOf(".png") !== -1 || urlLower.indexOf(".jpg") !== -1 || urlLower.indexOf(".jpeg") !== -1 || urlLower.indexOf(".gif") !== -1) {
                        $dialog.find(".dialogContent").removeClass("noScroll").append('<img src="' + options.url + '" controls></iframe>');
                    } else if (options.isInstructions || urlLower.indexOf(".md") !== -1) {
                        $dialog.find(".dialogContent").removeClass("noScroll").append('<div id="instructionsDialog"></div>');
                        window.setTimeout(function () {
                            instructionsProcessor.processUrl(options.url, "instructionsDialog");
                            if (options.url.indexOf("#") >= 0) {
                                window.setTimeout(function () {
                                    var hash = options.url.substr(options.url.indexOf("#"));
                                    var $element = $("#instructionsDialog " + hash);
                                    if ($element.length > 0) {
                                        $dialog.find(".dialogContent").scrollTop($element.position().top);
                                    }
                                }, 400); //leave time for the content to layout... the dialog takes 400ms to animate anyway, which should be sufficient.
                            }
                        }, 1);
                    } else {
                        $dialog.find(".dialogContent").addClass("noScroll").append('<iframe id="contentDialogIFrame" src="' + options.url + '" style="width:100%;height:100%;border:none;" allowfullscreen></iframe>');
                    }
                } else {
                    $dialog.find(".dialogContent").hide();
                }
                if (options.buttons && options.buttons.length > 0) {
                    $dialog.addClass("hasButtons");
                    var $dialogButtons = $dialog.find(".dialogButtons");
                    var numButtons = options.buttons.length;
                    for (var i = 0; i < numButtons; i++) {
                        var button = options.buttons[i];
                        var $button = $("<input type='button' value='" + button.text + "' />");
                        if (button.click) {
                            $button.click(button.click);
                        }
                        if (button.primary) {
                            $button.addClass("primary");
                        }
                        if (button.closeDialog) {
                            $button.click(close);
                        }
                        $dialogButtons.append($button);
                    }
                }
                if (!isUpdatedContent) {
                    $("body").append($dialog);
                    $dialog.hide().fadeIn("fast", function () {
                        if (options.open) {
                            options.open();
                        }
                    });
                    var h = $dialogBox.outerHeight();
                    var offset = $dialogBox.offset();
                    $dialogBox.css("marginTop", -h - offset.top).animate({ marginTop: 0 }, 400);
                }
                return {
                    close: close
                };
            }

        }

        function getScrollTop() {
            return document.body.scrollTop;
        }

    </script>


</body>
</html>
