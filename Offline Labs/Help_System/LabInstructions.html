<!DOCTYPE html>
<!-- saved from url=(0047)https://labondemand.com/LabProfile/Manual/LABID -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>Local Lab Instructions</title>


    <script src="./Content/jquery-2.1.4.min.js.download" type="text/javascript"></script>
    <script src="./Content/showdown.min.js.download"></script>
    <link rel="stylesheet" type="text/css" href="./Content/prettify.css">
    <script src="./Content/yaml.min.js.download"></script>
    <script src="./Content/LocalizeTo" type="text/javascript"></script>
    <link href="./Content/CloudClient.css" rel="stylesheet" type="text/css">
  
    <style type="text/css">
        body, html {
            font-family: Segoe UI,Tahoma,Verdana,Arial,sans-serif;
            font-size: 14px;
            padding: 0;
            margin: 0;
            background-color: #efefef;
            color: #000;
            height: 100%;
        }

        body {
            overflow:auto;
        }

        #outputWrapper {
            background-color: #efefef;
            min-height:100%;
        }

        .instructionsPreview {
            padding: 20px;
            height: 100%;
        }

        .instructionsPreview .page {
            position:relative;
            display: block !important;
            padding: 15px 20px;
            background-color:#fff;
            page-break-after: always;
            min-height:40px;
        }

        .instructionsPreview .page:not(:first-child) {
            margin-top:20px;
        }

        @media print {
            body, html{
                height:auto;
            }
            
            body {
                -webkit-print-color-adjust: exact;
            }

            div {
                page-break-inside: avoid;
            }

            #outputWrapper {
                background-color: transparent;
            }

            .instructionsPreview {
                padding: 0;
            }

            .instructionsPreview .page:not(:first-child) {
                margin-top: 0px;
            }

        }

        @page {
            margin-left: 1.5cm;
            margin-right: 1.5cm;
            margin-top: 1.5cm;
            margin-bottom: 1.5cm;
        }
    </style>
    <link id="themeStylesheet" href="./Content/Blue.css" rel="stylesheet">

</head>
<body>
    <div id="outputWrapper">
                <div id="instructions" class="instructionsPreview">
    </div>
    <input type="hidden" id="rawContent" value="[TemplateVersion]:
&#39;1.1&#39;

[LODLabID]:
&#39;39786&#39;

[LODLabNumber]:
&#39;05 FS.Help_System&#39;

[AdminPowerShell]:
```
powershell -NoProfile -command &quot;Start-Process powershell -Verb RunAs&quot;
exit
```

[AdminPowerShellISE]:
```
powershell -NoProfile -command &quot;Start-Process powershell_ise -Verb RunAs&quot;
exit
```

# Welcome student to the module: PowerShell Built-In Help System

The help system contains a vast amount of information which will support you to learn how to effectively use PowerShell to achieve your automation goals. There are different categories of information that can be selectively queried from different sources. This information can help you understand conceptual topics such as what is an advanced function, to detailed information such as which command to use and how to use it in order to achieve a specific goal. You will look at how to use the help system by executing queries and you will learn where to look in the results of your query in order to extract the critical information needed for the task at hand.


>[!ALERT] How to download the files needed for offline help was already shown in the slide-deck. There are also demo scripts available under C:\PShell\Labs\Demos demonstrating how to accomplish this in your infrastructure. The prerequisite steps for a fully functional offline help system have already been performed on the Win10 machine.

Estimated time to complete this lab: **30 minutes**

## Objectives:
After completing this lab you will be able to:
- Understand how to query the help system
- Know where to look in the results for the relevant information.


===

# Login to Windows 10 and Start the Lab

Login to **win10(wdt** machine with the given credentials. You can find them on the **Resources** pane.

Please login with Username: **+++Power+++** and Password: **+++Pa$$w0rd+++**

After logging in wait until you see the &quot;Lab preparation has been completed&quot; in the action center (This can take up to 2 minutes). If this does not popup you can click in the bottom right of the Vm to open the action center. Begin by opening Windows PowerShell ISE by right clicking on the PowerShell icon and selecting **Run ISE as an Administrator**, or by clicking @[Run ISE as Administrator.][AdminPowerShellISE]{shell visible}.

> [!TIP] **Notes about using the lab**
> - It might take a moment to start ISE if you click the above link
> - You can click the **+++Type Text+++** icon to enter the highlighted text at the position of the cursor in the virtual machine. You can also click on the **++Copyto Clipboard++** icon and then paste in at the desired destination.
> - Entering your code in the script pane of the ISE will allow for better troubleshooting if you find errors
> - Remember that the PowerShell ISE will allow you to highlight multiple lines of PowerShell code and run them together by pressing **F8**

===

# Exercise 1: Get-Help
In this exercise you will discover different ways of querying the help system using the Get-Help command and its parameters.

## Objectives
After completing this exercise, you will be able to:
- Query the help system using the Get-Help command.
- Understand the different ways of getting specific data from the help system.

===

# Task 1.1: Using commands to get help

1. [] Begin by opening Windows PowerShell ISE by right clicking on the PowerShell icon and selecting &quot;Run ISE as an Administrator, or by clicking @[Run ISE as Administrator.][AdminPowerShellISE]{shell visible}.


1. [] What is the name of the command used to get help?

    <details>
    <summary>Hint</summary>

    Use **Get-Command** to find a command that would get you help.
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    Get-Help
    </details>


1. [] Which of the below sections of information are shown when you invoke **Get-Help** passing in the name of a known command (i.e. **Get-Process**)?

   |**Section Name**|**Visible**|
   |:--|:--:|
   |Examples|[True or False](&quot;False&quot;)|
   |Synopsis|[True or False](&quot;True&quot;)|
   |Parameters|[True or False](&quot;False&quot;)|
   |Notes|[True or False](&quot;False&quot;)|
   |Syntax|[True or False](&quot;True&quot;)|
   |Parameter Sets|[True or False](&quot;True&quot;)|
   |Description|[True or False](&quot;True&quot;)|
   |Related Links|[True or False](&quot;True&quot;)|
   |Remarks|[True or False](&quot;True&quot;)|

1. [] How can you find which parameters that the command **Get-Help** has?

    <details>
    <summary>Hint</summary>

    What did the default output for calling **Get-Help** provide you with?
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    There are several alternative answers. Below a few possibilities.

    |**Command**|**Result**|
    |:--|:--|
    |Get-Help -Name Get-Help|Look at the Syntax and Parameters which are part of default output|
    |Get-Command -Name Get-Help -Syntax|Will show the syntax for the Get-Help Command|
    |Get-Help -Name Get-Help -Parameter * |Will show all the parameters with description for Get-Help|

    </details>



1. [] How should you invoke Get-Help in order to see only the description for the parameter *id* of the command Get-Process and what type of argument does the parameter take and what is it&#39;s purpose?


    <details>
    <summary>Hint</summary>

    Look at the parameters for Get-Help
    </details>
    <br>
    <details>
    <summary>Answer</summary>

    Get-Help Get-Process -Parameter id

    The id parameter expects an argument of type int32 which designated the Process ID of the process which you would like to have returned.
    </details>

1. [] Which of the below command calls will show you examples of how to use the command Get-ChildItem?

 |**Command**|**Desired Result**|
 |:--|:--:|
 |Get-Help dir -Examples|[True or False](&quot;True - *dir* is an Alias for Get-ChildItem&quot;)|
 |Get-Help -Name Get-ChildItem -Full|[True or False](&quot;True - Full also contains Examples&quot;)|
 |Get-Help -Samples Get-ChildItem |[True or False](&quot;False - There is no parameter *Samples*&quot;)|
 |Help dir -ex|[True or False](&quot;True - Uses function Help which abstracts Get-Help&quot;)|
 |Get-Help dir -Online|[True or False](&quot;True - Online help is full help including Examples&quot;)|
 |Get-ChildItem -?|[True or False](&quot;False - Only shows default help, Examples not included&quot;)|

===

# Exercise 2: Showing the Get-Help results in a dialog
The problem with using Get-Help can be parsing the results that can be long and by default are outputted to the console. There is a way to have the results show in a searchable dialog window.

## Objectives
After completing this exercise, you will be able to:
- Have your help query results show in a dialog.
- Understand how you can search and modify the dialog content.

===

# Task 2.1: Getting help results in a dialog

1. [] Invoke Get-Help using the -ShowWindow switch parameter using a command or keyword of your choice. Below is an example:

    ```PowerShell-notab
    Get-Help Get-Service -ShowWindow
    ```


1. [] The dialog which appears is not blocking meaning that you can continue editing your script or running your commands interactively in PowerShell ISE even thought the dialog is visible. Click on the Settings button in the upper right corner of the dialog. Notice the *Help Sections* checkboxes. Uncheck some and notice how the dialog content changes to reflect this.



1. [] Searching through the Help results:  In the dialog enter a word in the edit box next to the *Find:* label. Notice how you can easily search for items of interest within the results.


1. [] Context-Sensitive help is help for a word or words in the context of the script or command you are working with. Type any command either in the *script-pane* or *console-pane* of PowerShell_ISE. Place the cursor over a word or highlight one or more words and press F1. What Happens?

The word(s) which are in [&#39;\_\_\_\_\_\_\_&#39;](&quot;Context&quot;) are used as an [&#39;\_\_\_\_\_\_\_&#39;](&quot;Argument&quot;) for the -Name parameter of Get-Help. In addition the *switch* parameter  [&#39;\_\_\_\_\_\_\_&#39;](&quot;*ShowWindow*&quot;) is added to invoke Get-Help. The resulting command executed when F1 is press with the word *Get-Service* under the cursor is [&#39;\_\_\_\_\_\_\_&#39;](&quot;Get-Help Get-Service -ShowWindow&quot;)

===
# Exercise 3: Downloading Help content from the Internet.

A big portion of the help content comes from files that are not present initially on a system where PowerShell is installed. The help content files are associated with modules and since PowerShell v3.0 can be downloaded. The help content in files will be saved in the module location by default however can also be saved elsewhere (staged).

## Objectives

After completing this exercise, you will be able to:

-   Understand the prerequisites for downloading Module help content.
-   Download module help content from the internet and stage for use via the intranet/locally.

===
## Task 3.1: Understanding where some of help content is stored and retrieved

1. [] Check the help system status by running the following:

    ```PowerShell-notab
    Get-Help Get-Process -Full
    ```

    >[!KNOWLEDGE] The Get-Process command displays information about the processes on a local or remote computer.
    >
    >If Windows PowerShell has been recently installed and does not have internet access, you will not have access to the full help system. Only automatically generated help will be displayed.

    >[!KNOWLEDGE] The location of the help content for commands and modules are stored as properties of the Command and Module Objects. The property is called HelpInfoUri. Help content is updated using the Modules HelpInfoUri property. Calling Update-Help allows you to update for all Modules found in $env:PSModulePath or for specific ones specified using the **-Module** parameter when calling **Update-Help**. Commands are mostly implemented in modules and also can have additional help content which is stored in the module help files.

1. [] How can you see the location of the help for the command **Get-Process**:


    <details>
    <summary>Hint</summary>

    Look at the members of the command Get-Process.


        ```PowerShell-notabs
        Get-Command -Name Get-Process | Get-Member
        ```

    </details>
    <br>
    <details>
    <summary>Answer</summary>


     ```PowerShell-notabs
    # Local file that is associated with a Module (possibly updatable)
    (Get-Command -Name Get-Process).HelpFile
    &#39;Microsoft.PowerShell.Commands.Management.dll-Help.xml&#39;

    # Online Help
    (Get-Command -Name Get-Process).HelpUri
    Start &#39;https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-process?view=powershell-7.2&viewFallbackFrom=powershell-6&#39;
     ```

    </details>


1. [] Look at the source (Module) of the command **Get-Process** and then look at this modules HelpInfoUri property.


    <details>
    <summary>Hint</summary>


    ```PowerShell-notabs
    # Get the Module name
    (Get-Command -Name Get-Process).Modulename
    ```

    </details>
    <br>
    <details>
    <summary>Answer</summary>

    ```PowerShell-notabs
    # Get the HelpInfoUri for the Module
    (Get-Module -Name (Get-Command -Name Get-Process).Modulename).HelpInfoUri
    ```
    </details>


1. [] Update the module help content for the module which implements **Get-Process**. Use the *-Verbose* switch parameter when executing the command.


    <details>
    <summary>Hint</summary>

    Use the command Update-Help
    </details>
    <br>
    <details>
    <summary>Answer</summary>


    ```PowerShell-notabs
    Update-Help -Module Microsoft.PowerShell.Management -Verbose
    ```
    </details>

1. [] Look at previous command and verbose output and fill in the table below:


    |**Property**|**Value**|
    |:--|:--|
    |ModuleName|[\_\_\_\_\_\_\_\_\_\_\_\_\_\_](&quot;Microsoft.PowerShell.Management&quot;)|
    |Local HelpFile\Path|[\_\_\_\_\_\_\_\_\_\_\_\_\_\_](&quot;C:\Windows\System32\WindowsPowerShell\v1.0\en-US\Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;)|
    |Default Culture|[\_\_\_\_\_\_\_\_\_\_\_\_\_\_](&quot;En-Us&quot;)|
    |Original online location of content|[\_\_\_\_\_\_\_\_\_\_\_\_\_\_](&quot;https://pshelpprod.blob.core.windows.net/cabinets/powershell-5.1/&quot;)|


    >[!KNOWLEDGE] Help files are frequently updated. Remember to update your local help regularly. See **Get-Help about_Updatable_Help** for more information and for an example of scheduling a task to update help.
    >
    >Not all Modules support the updatable help file format. You may see errors if this is the case for specific modules.

    >[!ALERT] As you saw in the above exercises, downloading updatable help content (files) has several prerequisites:
    - Access to the content source - Default via internet.
    - The module information (i.e. Name and HelpInfoUri). This information is available by default only on machines with the module installed.
===

# Self test (Optional)

## Self test information

The following self test is a optional part of this course and can be used to evaluate if your knowledge of the subject matter is sufficient. You can use this self test to re-evaluate your knowledge after taking the course or test your knowledge before you take / retake the course.

This self test exists out of 10 questions and/or exercises. To get a fair result you should complete this self test using your knowledge only not by using any internet search engines.

##  Self test duration

Although the self test is not timed, this test should be completed in approximately 15 minutes.

To start the self test continue to the next page

===

## Self test

1. <Removed>
___

2. <Removed>
___

3. <Removed>
___

4. <Removed>
___

5. <Removed>
">
    <input type="hidden" id="activities" value="[]">
    <input type="hidden" id="replacementTokens" value="[{&quot;Token&quot;:&quot;@lab.LabProfile.Id&quot;,&quot;Replacement&quot;:&quot;38671&quot;},{&quot;Token&quot;:&quot;@lab.CtrlAltDelete&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;ctrlAltDeleteLink&#39;&gt;Ctrl+Alt+Delete&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(WIN10).SelectLink&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;selectMachineLink&#39; data-data=&#39;63124&#39;&gt;WIN10&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(WIN10).Username&quot;,&quot;Replacement&quot;:&quot;Power&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(WIN10).Password&quot;,&quot;Replacement&quot;:&quot;Pa$$$$w0rd&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(MS).SelectLink&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;selectMachineLink&#39; data-data=&#39;54597&#39;&gt;MS&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(MS).Username&quot;,&quot;Replacement&quot;:&quot;Power&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(MS).Password&quot;,&quot;Replacement&quot;:&quot;Pa$$$$w0rd&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(DC).SelectLink&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;selectMachineLink&#39; data-data=&#39;54598&#39;&gt;DC&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(DC).Username&quot;,&quot;Replacement&quot;:&quot;Administrator&quot;},{&quot;Token&quot;:&quot;@lab.VirtualMachine(DC).Password&quot;,&quot;Replacement&quot;:&quot;Pa$$$$w0rd&quot;},{&quot;Token&quot;:&quot;@lab.OpticalMedia(5638).LoadLink&quot;,&quot;Replacement&quot;:&quot;&lt;a href=&#39;#&#39; class=&#39;loadMediaLink opticalMedia&#39; data-data=&#39;5638&#39;&gt;Introduction to Commands - 0050&lt;/a&gt;&quot;},{&quot;Token&quot;:&quot;@lab.LabInstance.Id&quot;,&quot;Replacement&quot;:&quot;[ID]&quot;},{&quot;Token&quot;:&quot;@lab.LabInstance.GlobalId&quot;,&quot;Replacement&quot;:&quot;[lodID]&quot;},{&quot;Token&quot;:&quot;@lab.LabInstance.StartDate&quot;,&quot;Replacement&quot;:&quot;20190108&quot;},{&quot;Token&quot;:&quot;@lab.User.Id&quot;,&quot;Replacement&quot;:&quot;[USERID]&quot;},{&quot;Token&quot;:&quot;@lab.User.FirstName&quot;,&quot;Replacement&quot;:&quot;[FIRSTNAME]&quot;},{&quot;Token&quot;:&quot;@lab.User.LastName&quot;,&quot;Replacement&quot;:&quot;[LASTNAME]&quot;},{&quot;Token&quot;:&quot;@lab.User.Email&quot;,&quot;Replacement&quot;:&quot;[EMAIL]&quot;},{&quot;Token&quot;:&quot;@lab.User.ExternalId&quot;,&quot;Replacement&quot;:&quot;[EXTERNALID]&quot;},{&quot;Token&quot;:&quot;@lab.Tag&quot;,&quot;Replacement&quot;:&quot;[TAG]&quot;}]">

    <textarea id="copyInput" value="" style="position: absolute; left:-10000px; top:-10000px; "></textarea>

    <script type="text/javascript"> 
    
        String.prototype.replaceAll = function(search, replacement) {
            var target = this;
            return target.replace(new RegExp(search, 'g'), replacement);
        };

        var childWindows = [];

        function showClickFeedbackMessage(text, x, y, duration) {
            var $message = $("<div class='clickFeedbackMessage noselect'>" + text + "</div>");
            $message.appendTo($("body")).hide();
            $message.css({ left: x, top: y });
            $message.fadeIn("fast");
            window.setTimeout(function () {
                $message.fadeOut("fast", function () { $message.remove(); });
            }, duration);
        }

        function copyableClicked(element) {
            //only copy if we are clicking, not if we have used the mouse to select the text manually.
            var selectedText;
            if (window.getSelection) {
                selectedText = window.getSelection().toString();
            } else if (document.selection && document.selection.type !== "Control") {
                selectedText = document.selection.createRange().text;
            }
            if (selectedText) { return };

            var $element = $(element);
            var text = $element.text();
            $("#copyInput").val(text).select();
            var offset = $element.offset();
            var x = offset.left;
            var y = offset.top - 40;
            try {
                var successful = document.execCommand("copy");
                if (successful) {
                    showClickFeedbackMessage("Copied to clipboard", x, y, 2000);
                } else {
                    showClickFeedbackMessage("Copying was unsuccessful", x, y, 2000);
                }
            } catch (err) {
                showClickFeedbackMessage("Copying was unsuccessful", x, y, 2000);
                console.log("Unable to copy. " + err);
            }
        }

        function setupKnowledgeExpanders() {
            $(".knowledge").each(function () {
                var knowledge = this;
                var $knowledge = $(this);
                var $moreKnowledge = $knowledge.next();
                if ($moreKnowledge.is(".moreKnowledge")) {
                    var maxHeight = 100;
                    var leeway = 100;
                    var diff = knowledge.scrollHeight - maxHeight;
                    if (diff < leeway) {
                        $knowledge.removeClass("collapsed");
                        $moreKnowledge.find("a").hide();
                    } else {
                        //this is tall content, let's show the 'more' link
                        $moreKnowledge.find("a").show();
                        $knowledge.addClass("collapsed");
                    }
                }
            });
        }

        var variables = {};

        function processVariables() {
            $("span.variable").each(function () {
                var $this = $(this);
                var name = $this.attr("data-name");
                if (name in variables) {
                    $this.html(variables[name]);
                } else {
                    $this.text("<" + name + ">");
                }
            });
            $("input.variableTextBox").each(function () {
                var $this = $(this);
                var name = $this.attr("data-name");
                if (name in variables) {
                    $this.val(variables[name]);
                } else {
                    $this.val("");
                }
            });
            $("code").each(function () {
                var originalHtml = this.originalHtml ? this.originalHtml : this.innerHTML;
                var newHtml = originalHtml;
                for (var name in variables) {
                    var val = variables[name];
                    var regex = new RegExp('<span class="nocode">&lt;' + name + '&gt;</span>', 'g');
                    newHtml = newHtml.replace(regex, val);
                }
                if (originalHtml != newHtml || originalHtml != this.innerHTML) {
                    this.originalHtml = originalHtml;
                    this.innerHTML = newHtml;
                }
            });
        }
        
        window.onload = function () {

            var rawContent = document.getElementById("rawContent").value;
            var contentRoot = "./Content/"
            var activitiesString = document.getElementById("activities").value;
            var activities = (activitiesString == null || activitiesString.length == 0) ? [] : JSON.parse(activitiesString);
            var replacementTokensString = document.getElementById("replacementTokens").value;
            var replacementTokens = (replacementTokensString == null || replacementTokensString.length == 0) ? [] : JSON.parse(replacementTokensString);
            instructionsProcessor.process(rawContent, "instructions", false, contentRoot, replacementTokens,
                function ($page) {
                    setupKnowledgeExpanders();
                },
                activities
            );
            $(".page").each(function () {
                var $page = $(this);
                if ($page.find("iframe.externalManual").length > 0) {
                    $page.css("padding", 0);
                }
            });

            $("body").on("click", ".moreKnowledgeLink", function (e) {
                e.preventDefault();
                var $link = $(this);
                var $knowledge = $link.parent().prev();
                if ($knowledge.hasClass("expanded")) {
                    $knowledge.removeClass("expanded");
                    $link.text("more...");
                } else {
                    $knowledge.addClass("expanded");
                    $link.text("...less");
                }
            }).on("click", ".copyable, code:not(.nocopy)", function (e) {
                copyableClicked(this);
            }).on("click", ".dialogLink", function (e) {
                e.preventDefault();
                e.stopImmediatePropagation();
                var $dialogLink = $(this);
                var title = $dialogLink.attr("title");
                var target = $dialogLink.attr("data-target");
                if (target) {
                    var $hiddenDialog = $("blockquote.referenceContent[data-id='" + target + "']");
                    if ($hiddenDialog.length === 0) {
                        alert('CONTENT ERROR: Unable to find a reference content "' + target + '"');
                    } else {
                        showDialog({title:title, content: $hiddenDialog.html() });
                    }
                }
                else {
                    showDialog({title:title, url: $dialogLink.attr("href"), isInstructions: $dialogLink.hasClass("instructions") });
                }
            }).on("click", ".videoLink, video", function (e) {
                e.preventDefault();
                var videoUrl = $(this).hasClass("videoLink") ? this.href : this.src;
                var url = "./Content/" + videoUrl.split('Content/').pop().replace(/\#(.*?)$/, '').replace(/\?(.*?)$/, '')
                if (this.title) {
                    
                }
                var videoWindow = window.open(url, "videoWindow", "menubar=no,location=no,resizable=yes,scrollbars=yes,status=no");
                childWindows.push(videoWindow);
                try {
                    videoWindow.focus();
                } catch (e) {

                }
            }).on("click", ".imageLink, img", function (e) {
                var $this = $(this);
                if ($this.parent().is("a")) return;
                e.preventDefault();
                e.stopImmediatePropagation();
                var imgUrl = $this.hasClass("imageLink") ? this.href : this.src;
                var url = "./Content/" + imgUrl.split('Content/').pop().replace(/\#(.*?)$/, '').replace(/\?(.*?)$/, '')
                if (this.title) {
                    
                }
                var imageWindow = window.open(url, "imageWindow", "menubar=no,location=no,resizable=yes,scrollbars=yes,status=no");
                childWindows.push(imageWindow);
                try {
                    imageWindow.focus();
                } catch (e) {

                }
            }).on("click", ".tipLink", function (e) {
                e.preventDefault();
                var $tiplink = $(this);
                var $hiddenTip = $tiplink.next();
                var offset = $(this).offset();
                var x = offset.left;
                var y = offset.top + 25;
                showClickFeedbackMessage($hiddenTip.html().replaceAll('<code title="Copy to clipboard" class="prettyprint">','<code title="Copy to clipboard" style="background-color:#8888;" class="prettyprint">').replaceAll("class",'style="background-color:#8888;" class'), x, y, 5000);
            }).on("change", ".variableTextBox", function () {
                var $textBox = $(this);
                var name = $textBox.attr("data-name");
                var val = $textBox.val();
                if (val == null || val.length == 0) {
                    if (name in variables) {
                        delete variables[name];
                    }
                } else {
                    variables[name] = val;
                }
                processVariables();
            });;

            $(window).resize(function () {
                setupKnowledgeExpanders();
            }).unload(function () {
                closeAllChildWindows();
            });

            function closeAllChildWindows() {
                for (var i = 0; i < childWindows.length; i++) {
                    try {
                        childWindows[i].close();
                    } catch (e) {
                    }
                }
                childWindows = [];
            }

            function showDialog(options) {
                if (!options) return;
                var $dialog = $("#modalDialog");
                var isUpdatedContent = false;
                if ($dialog.length > 0) {
                    $dialog.find(".dialogContent").html("");
                    $dialog.find(".dialogButtons").html("");
                    isUpdatedContent = true;
                } else {
                    var $dialog = $('<div id="modalDialog" class="dialog"><div class="dialogMask"></div><div class="dialogBox"><div class="dialogCloseButton"></div><div class="dialogTitle"></div><div class="dialogContent"></div><div class="dialogButtons"></div></div></div>');
                }
                var $dialogBox = $dialog.find(".dialogBox");
                var close = function () {
                    var h = $dialogBox.outerHeight();
                    var offset = $dialogBox.offset();
                    $dialogBox.css("marginTop", 0).animate({ marginTop: -h - offset.top }, 300);
                    $dialog.delay(200).fadeOut("fast", function () { $dialog.remove(); });
                }
                $dialog.find(".dialogCloseButton").click(close);

                if (options.title) {
                    $dialog.find(".dialogTitle").html(options.title).show();
                } else {
                    $dialog.find(".dialogTitle").hide();
                    $dialog.addClass("noTitle");
                }
                if (options.content) {
                    $dialog.find(".dialogContent").removeClass("noScroll").append(options.content);
                } else if (options.url) {
                    var urlLower = options.url.toLowerCase();
                    if (urlLower.indexOf(".mp4") !== -1) {
                        $dialog.find(".dialogContent").removeClass("noScroll").append('<video src="' + options.url + '" controls autoplay></video>');
                        var $video = $("#contentDialogVideo");
                        try {
                            $video[0].play();
                        } catch (e) {
                            //
                        }
                    } else if (urlLower.indexOf(".png") !== -1 || urlLower.indexOf(".jpg") !== -1 || urlLower.indexOf(".jpeg") !== -1 || urlLower.indexOf(".gif") !== -1) {
                        $dialog.find(".dialogContent").removeClass("noScroll").append('<img src="' + options.url + '" controls></iframe>');
                    } else if (options.isInstructions || urlLower.indexOf(".md") !== -1) {
                        $dialog.find(".dialogContent").removeClass("noScroll").append('<div id="instructionsDialog"></div>');
                        window.setTimeout(function () {
                            instructionsProcessor.processUrl(options.url, "instructionsDialog");
                            if (options.url.indexOf("#") >= 0) {
                                window.setTimeout(function () {
                                    var hash = options.url.substr(options.url.indexOf("#"));
                                    var $element = $("#instructionsDialog " + hash);
                                    if ($element.length > 0) {
                                        $dialog.find(".dialogContent").scrollTop($element.position().top);
                                    }
                                }, 400); //leave time for the content to layout... the dialog takes 400ms to animate anyway, which should be sufficient.
                            }
                        }, 1);
                    } else {
                        $dialog.find(".dialogContent").addClass("noScroll").append('<iframe id="contentDialogIFrame" src="' + options.url + '" style="width:100%;height:100%;border:none;" allowfullscreen></iframe>');
                    }
                } else {
                    $dialog.find(".dialogContent").hide();
                }
                if (options.buttons && options.buttons.length > 0) {
                    $dialog.addClass("hasButtons");
                    var $dialogButtons = $dialog.find(".dialogButtons");
                    var numButtons = options.buttons.length;
                    for (var i = 0; i < numButtons; i++) {
                        var button = options.buttons[i];
                        var $button = $("<input type='button' value='" + button.text + "' />");
                        if (button.click) {
                            $button.click(button.click);
                        }
                        if (button.primary) {
                            $button.addClass("primary");
                        }
                        if (button.closeDialog) {
                            $button.click(close);
                        }
                        $dialogButtons.append($button);
                    }
                }
                if (!isUpdatedContent) {
                    $("body").append($dialog);
                    $dialog.hide().fadeIn("fast", function () {
                        if (options.open) {
                            options.open();
                        }
                    });
                    var h = $dialogBox.outerHeight();
                    var offset = $dialogBox.offset();
                    $dialogBox.css("marginTop", -h - offset.top).animate({ marginTop: 0 }, 400);
                }
                return {
                    close: close
                };
            }

        }

        function getScrollTop() {
            return document.body.scrollTop;
        }

    </script>


</body>
</html>
